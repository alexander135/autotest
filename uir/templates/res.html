{% extends "base.html" %}
{% block content %}

<div class = cont>
    <div class = title>
        <a class = main-but href =/ ><button> Home</button></a>
        <h1 class = name>Job : {{results['job']['name']}}</h1>
    </div>
<div class = content>
<div class =spoiler>
    <span class = blue>Info</span>
    <input type = checkbox>
        <div class = info>
        {% for key,value in results['job'].items() if key!='name' %}
            <span>
            {{key}}: {{value}}; 
            </span>
            <br>
        {% endfor %}
        <span>Data was updated {{last_update}}</span>
        <br>
        <span>Comment: {% if results['job']['comment'] %} {{ results['job']['comment'] }}{% endif %}
        <form id = 'comment-form' method = "POST" style = "display:none">
        <input type = 'text' value = {{results['job']['comment']}}>
        </form>
        <i class = "far fa-edit" href = ""></i>
        
        </span>
        </div>
</div>

<div class = tables>
        <table class = {{ class }}>
            <caption>
                    Tests results
            </caption> 
            <tr class ="bg-secondary text-light">
                <td>Test Type</td>
                <td>Passed</td>
                <td>Failed</td>
                <td>Skipped</td>
                <td>Total</td>
                <td>Success %</td>
            </tr>
            
            {% for name in results %}
                {% if name != 'job' and name != '_id' %}
                    <tr  class = {{ results[name]['color']}}>
                        <td>{{name}}</td>
                        {% for i in results[name] if i != 'color'%}

                        <td>{{ results[name][i]}}</td>
                    
                    {% endfor %}
                </tr>
                {% endif %}
            {% endfor %}        
        </table>
        
        <table class = {{class}}>
            <caption>
                    Summed tests results
            </caption> 
            <tr class ="bg-secondary text-light">
                <td>Tests Type</td>
                <td>Passed</td>
                <td>Failed</td>
                <td>Skipped</td>
                <td>Total</td>
                <td>Success %</td>
            </tr>
            {% for name in summed_res.keys() %}
                <tr class ={{ summed_res[name]['color']}}>
                    <td>
                        {{name}}
                    </td>
                    {% for i in summed_res[name] if i != 'color' %}
                    <td>
                        {{ summed_res[name][i] }}
                    </td>
                    {% endfor %}
                </tr>
            {% endfor %}
        </table>
        </div>
        </div>
        <div class = but>
            {% if pk > 1 %}
            <a href = "./{{pk-1}}"><button><i class ="fas fa-long-arrow-alt-left"></i></button></a>
            {% endif %}
            <a href = "./{{pk}}/update"><button> update </button></a>
            {% if total > pk %}
            <a href = "./{{pk+1}}"><button><i class = "fas fa-long-arrow-alt-right"></i></button></a>
            {% endif %}
        </div>
            {% if message %}
            <h2 class = mes> {{message}}</h2>
            {% endif %}
</div>
{% endblock %}

{% block script %}

<script src = "{{url_for('static', filename = 'js/edit_form.js')}}"></script>

{% endblock %}


